# **Revised Implementation Plan: SharePoint Inventory App**

Version: 4.0 (Invoice-Driven Model)  
Date: July 14, 2025

### **ðŸ“Œ Project Goal**

Build a light-weight, React-based inventory appâ€”hosted for free on Azure Static Web Appsâ€”that lets authenticated staff:

1. Log inbound (received) parts.  
2. **Create invoices to sell parts, which automatically generates transaction records and updates inventory.**  
3. View simple on-hand/value summaries.  
4. Look up parts on external sites like RockAuto.com and Google.

All data resides in SharePoint Online lists. SharePointâ€™s built-in Created By / Modified By auditing records who performed each action.

### **1\. High-Level Architecture**

| Layer | Technology | Justification |
| :---- | :---- | :---- |
| **Frontend** | React 18 \+ Vite, Tailwind CSS, Recharts | Modern, modular components for fast development; a free and powerful open-source stack. |
| **Auth** | MSAL.js (Microsoft Authentication Library) | Enables users to sign in with their existing Microsoft 365 work accounts; the token is reused for every API call, ensuring secure access. |
| **Data API** | **Microsoft Graph API** (Preferred) | The modern, unified endpoint for all Microsoft 365 data. Provides consistent syntax and is the future-facing standard for M365 development. |
| **Hosting** | **Azure Static Web Apps (Free Plan)** | Provides 100 GB/month egress, custom domains, free SSL, and integrated CI/CD with GitHub Actions. The most efficient and scalable choice. |

### **2\. SharePoint List Design**

The data model has been updated to be invoice-centric for all sales. All lists use the simt\_ prefix for clear organization.

#### **2.1 simt\_Categories**

Centralizes product families and categories.

| Column (System Name) | Display Name | Type | Notes |
| :---- | :---- | :---- | :---- |
| **Title** | **Category** | Single line of text | The name of the Category (e.g., "Brake Hose"). **Unique Key**. |
| **Family** | Family | Choice | The parent family for the category (e.g., "Brake & Wheel Hub"). |

#### **2.2 simt\_Parts**

The master catalog for all inventory items.

| Column | Type | Notes |
| :---- | :---- | :---- |
| **Title (Part ID)** | Single line of text | **Unique Key**. Indexed for performance. |
| Description | Multiple lines | â€” |
| **Category** | **Lookup** | Looks up to the Title column in the simt\_Categories list. |
| **InventoryOnHand** | **Number** | Stores the current on-hand quantity. |
| UnitCost | Currency | The cost paid for the part. |
| UnitPrice | Currency | The default selling price. |
| Status | Choice | Active, Obsolete, Disposed. |

#### **2.3 simt\_Buyers**

A simple list of customers.

| Column (System Name) | Display Name | Type |
| :---- | :---- | :---- |
| **Title** | **Buyer Name** | Single line of text |
| Contact Email | Contact Email | Single line of text |
| Phone | Phone | Single line of text |

#### **2.4 simt\_Invoices (New List)**

This new list is the core of the sales process, grouping all items from a single sale.

| Column (System Name) | Display Name | Type | Notes |
| :---- | :---- | :---- | :---- |
| **Title** | **Invoice \#** | Single line of text | **Unique Key**. Can be auto-generated by the app. |
| **Buyer** | Buyer | Lookup | Looks up to the simt\_Buyers list. |
| **InvoiceDate** | Invoice Date | Date and Time | â€” |
| **TotalAmount** | Total Amount | Currency | Calculated sum of all line items. |
| **Status** | Status | Choice | Draft, Finalized, Paid, Void. |

#### **2.5 simt\_Transactions (Revised Movement History)**

This list is now the detailed ledger. "Out" movements are created exclusively by the invoicing process.

| Column | Type | Notes |
| :---- | :---- | :---- |
| **Part** | Lookup â†’ simt\_Parts | **Required.** |
| **MovementType** | Choice | In (Received) / Out (Sold). |
| **Quantity** | Number | Always a positive number. |
| **Invoice** | **Lookup** | **Looks up to simt\_Invoices. Required for "Out" movements.** |
| UnitCost | Currency | For "In" movements. |
| UnitPrice | Currency | For "Out" movements. |
| Notes | Multiple lines | â€” |
| **Created By** | Person (System) | Automatically captures the user. |

### **3\. Frontend Component Map**

| Component | Purpose |
| :---- | :---- |
| **InvoiceList / InvoiceForm** | **New core components for creating, viewing, and managing customer invoices.** |
| TransactionForm | Now used primarily for logging **inbound** parts or making manual inventory adjustments. |
| PartsTable / PartForm | CRUD operations for the master parts catalog. |
| BuyersTable / BuyerForm | CRUD operations for the buyers list. |
| Dashboard | Fetches data to render summary cards and charts. |
| ExternalLookup | Provides a search interface to look up parts. |
| Shared/UI | Reusable components like dropdowns, modals, toasts, and loaders. |

### **4\. Authentication & API Flow**

The sales workflow is now centered around the invoice.

1. User signs into the application via MSAL.js.  
2. **To sell parts, the user creates a new Invoice in the InvoiceForm.** They select a buyer and add multiple parts as line items.  
3. When the user clicks "Finalize Invoice":  
   a. The app first creates a single new item in the simt\_Invoices list.  
   b. The app then loops through each line item on the invoice. For each part:  
   i. It creates a corresponding simt\_Transactions record with MovementType: "Out (Sold)", linking it to the new Invoice.  
   ii. It sends a PATCH request to the simt\_Parts list to decrease the InventoryOnHand for that specific part.  
4. This ensures all sales are atomic and auditable through a single invoice record.

### **5\. DevOps & Deployment**

| Step | Detail |
| :---- | :---- |
| **Repository** | GitHub (main for production, dev for development). |
| **Build** | npm run build (Vite) generates static assets in the dist/ folder. |
| **CI/CD** | A GitHub Action, auto-generated by Azure Static Web Apps, builds and deploys the app. Pull requests automatically generate preview environments. |
| **Environments** | Tenant ID, Client ID, and SharePoint List IDs are stored securely as **Configuration** secrets in the Azure Static Web App. |
| **Release** | Merging the dev branch into main triggers the production deployment. |

### **6\. Implementation Phases & Timeline**

The timeline is adjusted to include the new invoice components.

| Phase | Major Tasks | Owner | ETA |
| :---- | :---- | :---- | :---- |
| **1\. Foundation** | â€¢ Create SharePoint lists & columns as defined above.\<br\>â€¢ Create a dedicated M365/SharePoint security group for users.\<br\>â€¢ Register the Azure AD application. | IT Admin | Week 1 |
| **2\. Skeleton** | â€¢ Scaffold the React app with Vite and Tailwind CSS.\<br\>â€¢ Implement MSAL authentication and protected routes. | Dev | Week 2 |
| **3\. Core Features** | â€¢ Build Parts & Buyers CRUD components.\<br\>â€¢ **Build Invoice creation and management components (InvoiceList, InvoiceForm).**\<br\>â€¢ Build the inbound Transaction form.\<br\>â€¢ Implement validation and toast notifications. | Dev | Weeks 3-5 |
| **4\. Reporting** | â€¢ Develop aggregate queries for the dashboard.\<br\>â€¢ Build dashboard charts and summary tables with Recharts. | Dev | Week 6 |
| **5\. QA & UAT** | â€¢ Test the full invoice-to-transaction workflow.\<br\>â€¢ Test permissions via the security group.\<br\>â€¢ Secure stakeholder sign-off. | QA & Stakeholders | Week 7 |
| **6\. Go-Live** | â€¢ Deploy to production.\<br\>â€¢ Conduct a user training workshop.\<br\>â€¢ Monitor Azure logs and quotas. | DevOps | Week 8 |

### **7\. Security & Governance Checklist**

* \[x\] âœ… Use HTTPS-only via Azure Static Web Apps (SSL is automatic).  
* \[x\] âœ… Grant the app only the necessary delegated Microsoft Graph scopes (Sites.ReadWrite.All).  
* \[x\] âœ… Store SharePoint lists in a private Microsoft 365 site.  
* \[x\] âœ… **Manage access using a dedicated SharePoint security group instead of individual user permissions.**  
* \[ \] â¬œ Configure Conditional Access / MFA for users if not already enforced at the organization level.  
* \[ \] â¬œ Set up a budget alert in Azure for the Static Web App to monitor the 100 GB free bandwidth quota.

### **8\. Future Enhancements**

| Idea | Benefit |
| :---- | :---- |
| **Row-Level Security** | Use SharePoint's item-level permissions to restrict access so teams see only their own parts. |
| **Serverless Notifications** | Use an Azure Function (triggered by a list webhook) to send Teams notifications on large sales. |
| **Power BI Integration** | Point a Power BI dataset directly at the SharePoint lists for advanced, rich analytics. |
| **Offline Excel Sync** | Allow power users to perform bulk edits via Excel and sync back to the lists. |
| **Progressive Web App (PWA)** | Add a manifest file to enable "Add to Home Screen" functionality on warehouse tablets for easy access. |

