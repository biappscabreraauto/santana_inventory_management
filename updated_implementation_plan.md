# **Revised Implementation Plan: SharePoint Inventory App**

Version: 4.1 (Invoice-Driven Model - Progress Update)  
Date: July 14, 2025

### **Project Goal**

Build a light-weight, React-based inventory app—hosted for free on Azure Static Web Apps—that lets authenticated staff:

1. Log inbound (received) parts.  
2. **Create invoices to sell parts, which automatically generates transaction records and updates inventory.**  
3. View simple on-hand/value summaries.  
4. Look up parts on external sites like RockAuto.com and Google.

All data resides in SharePoint Online lists. SharePoint's built-in Created By / Modified By auditing records who performed each action.

### **1. High-Level Architecture**

| Layer | Technology | Justification |
| :---- | :---- | :---- |
| **Frontend** | React 18 + Vite, Tailwind CSS, Recharts | Modern, modular components for fast development; a free and powerful open-source stack. |
| **Auth** | MSAL.js (Microsoft Authentication Library) | Enables users to sign in with their existing Microsoft 365 work accounts; the token is reused for every API call, ensuring secure access. |
| **Data API** | **Microsoft Graph API** (Preferred) | The modern, unified endpoint for all Microsoft 365 data. Provides consistent syntax and is the future-facing standard for M365 development. |
| **Hosting** | **Azure Static Web Apps (Free Plan)** | Provides 100 GB/month egress, custom domains, free SSL, and integrated CI/CD with GitHub Actions. The most efficient and scalable choice. |

### **2. SharePoint List Design**

The data model has been updated to be invoice-centric for all sales. All lists use the simt_ prefix for clear organization.

#### **2.1 simt_Categories**

Centralizes product families and categories.

| Column (System Name) | Display Name | Type | Notes |
| :---- | :---- | :---- | :---- |
| **Title** | **Category** | Single line of text | The name of the Category (e.g., "Brake Hose"). **Unique Key**. |
| **Family** | Family | Choice | The parent family for the category (e.g., "Brake & Wheel Hub"). |

#### **2.2 simt_Parts**

The master catalog for all inventory items.

| Column | Type | Notes |
| :---- | :---- | :---- |
| **Title (Part ID)** | Single line of text | **Unique Key**. Indexed for performance. |
| Description | Multiple lines | — |
| **Category** | **Lookup** | Looks up to the Title column in the simt_Categories list. |
| **InventoryOnHand** | **Number** | Stores the current on-hand quantity. |
| UnitCost | Currency | The cost paid for the part. |
| UnitPrice | Currency | The default selling price. |
| Status | Choice | Active, Obsolete, Disposed. |

#### **2.3 simt_Buyers**

A simple list of customers.

| Column (System Name) | Display Name | Type |
| :---- | :---- | :---- |
| **Title** | **Buyer Name** | Single line of text |
| Contact Email | Contact Email | Single line of text |
| Phone | Phone | Single line of text |

#### **2.4 simt_Invoices (New List)**

This new list is the core of the sales process, grouping all items from a single sale.

| Column (System Name) | Display Name | Type | Notes |
| :---- | :---- | :---- | :---- |
| **Title** | **Invoice #** | Single line of text | **Unique Key**. Can be auto-generated by the app. |
| **Buyer** | Buyer | Lookup | Looks up to the simt_Buyers list. |
| **InvoiceDate** | Invoice Date | Date and Time | — |
| **TotalAmount** | Total Amount | Currency | Calculated sum of all line items. |
| **Status** | Status | Choice | Draft, Finalized, Paid, Void. |

#### **2.5 simt_Transactions (Revised Movement History)**

This list is now the detailed ledger. "Out" movements are created exclusively by the invoicing process.

| Column | Type | Notes |
| :---- | :---- | :---- |
| **Part** | Lookup → simt_Parts | **Required.** |
| **MovementType** | Choice | In (Received) / Out (Sold). |
| **Quantity** | Number | Always a positive number. |
| **Invoice** | **Lookup** | **Looks up to simt_Invoices. Required for "Out" movements.** |
| UnitCost | Currency | For "In" movements. |
| UnitPrice | Currency | For "Out" movements. |
| Notes | Multiple lines | — |
| **Created By** | Person (System) | Automatically captures the user. |

### **3. Frontend Component Map**

| Component | Purpose |
| :---- | :---- |
| **InvoiceList / InvoiceForm** | **New core components for creating, viewing, and managing customer invoices.** |
| TransactionForm | Now used primarily for logging **inbound** parts or making manual inventory adjustments. |
| PartsTable / PartForm | CRUD operations for the master parts catalog. |
| BuyersTable / BuyerForm | CRUD operations for the buyers list. |
| Dashboard | Fetches data to render summary cards and charts. |
| ExternalLookup | Provides a search interface to look up parts. |
| Shared/UI | Reusable components like dropdowns, modals, toasts, and loaders. |

### **4. Authentication & API Flow**

The sales workflow is now centered around the invoice.

1. User signs into the application via MSAL.js.  
2. **To sell parts, the user creates a new Invoice in the InvoiceForm.** They select a buyer and add multiple parts as line items.  
3. When the user clicks "Finalize Invoice":  
   a. The app first creates a single new item in the simt_Invoices list.  
   b. The app then loops through each line item on the invoice. For each part:  
   i. It creates a corresponding simt_Transactions record with MovementType: "Out (Sold)", linking it to the new Invoice.  
   ii. It sends a PATCH request to the simt_Parts list to decrease the InventoryOnHand for that specific part.  
4. This ensures all sales are atomic and auditable through a single invoice record.

### **5. DevOps & Deployment**

| Step | Detail |
| :---- | :---- |
| **Repository** | GitHub (main for production, dev for development). |
| **Build** | npm run build (Vite) generates static assets in the dist/ folder. |
| **CI/CD** | A GitHub Action, auto-generated by Azure Static Web Apps, builds and deploys the app. Pull requests automatically generate preview environments. |
| **Environments** | Tenant ID, Client ID, and SharePoint List IDs are stored securely as **Configuration** secrets in the Azure Static Web App. |
| **Release** | Merging the dev branch into main triggers the production deployment. |

### **6. Implementation Phases & Timeline**

The timeline is adjusted to include the new invoice components.

| Phase | Major Tasks | Owner | ETA | Status |
| :---- | :---- | :---- | :---- | :---- |
| **1. Foundation** | • **COMPLETED:** Create SharePoint lists & columns as defined above.<br>• **COMPLETED:** Create a dedicated M365/SharePoint security group for users.<br>• **COMPLETED:** Register the Azure AD application. | IT Admin | Week 1 | **COMPLETED** |
| **2. Skeleton** | • **COMPLETED:** Scaffold the React app with Vite and Tailwind CSS.<br>• **COMPLETED:** Implement MSAL authentication and protected routes. | Dev | Week 2 | **COMPLETED** |
| **3. Core Features** | • Build Parts & Buyers CRUD components.<br>• **Build Invoice creation and management components (InvoiceList, InvoiceForm).**<br>• Build the inbound Transaction form.<br>• Implement validation and toast notifications. | Dev | Weeks 3-5 | **IN PROGRESS** |
| **4. Reporting** | • Develop aggregate queries for the dashboard.<br>• Build dashboard charts and summary tables with Recharts. | Dev | Week 6 | **PENDING** |
| **5. QA & UAT** | • Test the full invoice-to-transaction workflow.<br>• Test permissions via the security group.<br>• Secure stakeholder sign-off. | QA & Stakeholders | Week 7 | **PENDING** |
| **6. Go-Live** | • Deploy to production.<br>• Conduct a user training workshop.<br>• Monitor Azure logs and quotas. | DevOps | Week 8 | **PENDING** |

### **7. Security & Governance Checklist**

* [x] **COMPLETED:** Use HTTPS-only via Azure Static Web Apps (SSL is automatic).  
* [x] **COMPLETED:** Grant the app only the necessary delegated Microsoft Graph scopes (Sites.ReadWrite.All).  
* [x] **COMPLETED:** Store SharePoint lists in a private Microsoft 365 site.  
* [x] **COMPLETED:** **Manage access using a dedicated SharePoint security group instead of individual user permissions.**  
* [ ] Configure Conditional Access / MFA for users if not already enforced at the organization level.  
* [ ] Set up a budget alert in Azure for the Static Web App to monitor the 100 GB free bandwidth quota.

### **8. Future Enhancements**

| Idea | Benefit |
| :---- | :---- |
| **Row-Level Security** | Use SharePoint's item-level permissions to restrict access so teams see only their own parts. |
| **Serverless Notifications** | Use an Azure Function (triggered by a list webhook) to send Teams notifications on large sales. |
| **Power BI Integration** | Point a Power BI dataset directly at the SharePoint lists for advanced, rich analytics. |
| **Offline Excel Sync** | Allow power users to perform bulk edits via Excel and sync back to the lists. |
| **Progressive Web App (PWA)** | Add a manifest file to enable "Add to Home Screen" functionality on warehouse tablets for easy access. |

---

### **Current Status Summary**

**COMPLETED:**
- Azure AD application registration and permissions
- SharePoint Online lists creation (all 5 lists)
- MSAL authentication implementation
- Basic React app structure with Tailwind CSS
- Protected routes and user authentication flow

**NEXT PHASE:**
Ready to begin building the core CRUD components for Parts, Buyers, Invoices, and Transactions management.